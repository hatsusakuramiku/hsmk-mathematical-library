classdef TriangleSimplexIntegral < handle

    properties (Access = public, Constant = true)
        % integral formula names
        formulas = {'ORDER1POINT3', 'ORDER3POINT7', 'ORDER5POINT12', 'ORDER7POINT18', 'ORDER7POINT27', 'ORDER10POINT30', 'ORDER11POINT36_v1', 'ORDER11POINT36_v2', 'ORDER11POINT36_v3', 'ORDER11POINT36_v4', 'ORDER11POINT36_v5', 'ORDER11POINT36_v6', 'ORDER11POINT36_v7', 'ORDER11POINT36_v8'};
        % integral points and weights, format: [x, y, w]
        % all of them are for the triangle with vertices (0,0), (1,0) and (0,1)
        % see https://hsmkhexo.s3.ap-northeast-1.amazonaws.com/other/%E7%A7%AF%E5%88%86%E5%85%AC%E5%BC%8F%E6%80%BB%E7%BB%93.pdf
        ORDER1POINT3 = [0.0, 0.0, 0.16666666666666666; 1.0, 0.0, 0.16666666666666666; 0.0, 1.0, 0.16666666666666666; ];
        ORDER3POINT7 = [0.0, 0.0, 0.025; 1.0, 0.0, 0.025; 0.0, 1.0, 0.025; 0.5, 0.0, 0.06666666666666667; 0.0, 0.5, 0.06666666666666667; 0.5, 0.5, 0.06666666666666667; 1.0, 0.5, 0.06666666666666667; 0.5, 1.0, 0.06666666666666667; 0.3333333333333333, 0.3333333333333333, 0.225; ];
        ORDER5POINT12 = [0.0, 0.0, 0.0074364565124102906; 1.0, 0.0, 0.0074364565124102906; 0.0, 1.0, 0.0074364565124102906; 0.2934695559090401, 0.0, 0.024420840617025503; 0.0, 0.2934695559090401, 0.024420840617025503; 0.7065304440909599, 0.2934695559090401, 0.024420840617025503; 0.2934695559090401, 0.7065304440909599, 0.024420840617025503; 0.0, 0.7065304440909599, 0.024420840617025503; 0.7065304440909599, 0.0, 0.024420840617025503; 0.20734517566359092, 0.20734517566359092, 0.11038852892020537; 0.5853096486728182, 0.20734517566359092, 0.11038852892020537; 0.20734517566359092, 0.5853096486728182, 0.11038852892020537; ];
        ORDER7POINT18 = [0.0, 0.0, 0.0031746031746031746; 1.0, 0.0, 0.0031746031746031746; 0.0, 1.0, 0.0031746031746031746; 0.5, 0.0, 0.012698412698412698; 0.0, 0.5, 0.012698412698412698; 0.5, 0.5, 0.012698412698412698; 1.0, 0.5, 0.012698412698412698; 0.5, 1.0, 0.012698412698412698; 0.21132486540518713, 0.0, 0.009146341463414634; 0.0, 0.21132486540518713, 0.009146341463414634; 0.7886751345948129, 0.21132486540518713, 0.009146341463414634; 0.21132486540518713, 0.7886751345948129, 0.009146341463414634; 0.0, 0.7886751345948129, 0.009146341463414634; 0.7886751345948129, 0.0, 0.009146341463414634; 0.4247639617258106, 0.4247639617258106, 0.0787812144693918; 0.1504720765483788, 0.4247639617258106, 0.0787812144693918; 0.4247639617258106, 0.1504720765483788, 0.0787812144693918; 0.13079159382974495, 0.13079159382974495, 0.05058386489568756; 0.7384168123405102, 0.13079159382974495, 0.05058386489568756; 0.13079159382974495, 0.7384168123405102, 0.05058386489568756; ];
        ORDER7POINT27 = [0.0, 0.0, 7.425845258035245E-4; 1.0, 0.0, 7.425845258035245E-4; 0.0, 1.0, 7.425845258035245E-4; 0.5, 0.0, 5.228925775971095E-4; 0.0, 0.5, 5.228925775971095E-4; 0.5, 0.5, 5.228925775971095E-4; 1.0, 0.5, 5.228925775971095E-4; 0.5, 1.0, 5.228925775971095E-4; 0.1044413784858067, 0.0, 0.005780744536385346; 0.0, 0.1044413784858067, 0.005780744536385346; 0.8955586215141933, 0.1044413784858067, 0.005780744536385346; 0.1044413784858067, 0.8955586215141933, 0.005780744536385346; 0.0, 0.8955586215141933, 0.005780744536385346; 0.8955586215141933, 0.0, 0.005780744536385346; 0.1124612712776796, 0.1124612712776796, 0.03143086701106134; 0.7750774574446408, 0.1124612712776796, 0.03143086701106134; 0.1124612712776796, 0.7750774574446408, 0.03143086701106134; 0.03964634972921077, 0.3373407414205641, 0.02670516378072029; 0.3373407414205641, 0.03964634972921077, 0.02670516378072029; 0.6230129088502252, 0.3373407414205641, 0.02670516378072029; 0.3373407414205641, 0.6230129088502252, 0.02670516378072029; 0.03964634972921077, 0.6230129088502252, 0.02670516378072029; 0.6230129088502252, 0.03964634972921077, 0.02670516378072029; 0.1868572380229495, 0.3156575833835992, 0.0344992529589967; 0.3156575833835992, 0.1868572380229495, 0.0344992529589967; 0.49748517859345126, 0.3156575833835992, 0.0344992529589967; 0.3156575833835992, 0.49748517859345126, 0.0344992529589967; 0.1868572380229495, 0.49748517859345126, 0.0344992529589967; 0.49748517859345126, 0.1868572380229495, 0.0344992529589967; ];
        ORDER10POINT30 = [0.0, 0.0, 7.425845258035245E-4; 1.0, 0.0, 7.425845258035245E-4; 0.0, 1.0, 7.425845258035245E-4; 0.363298074153686, 0.0, 0.006190565003676629; 0.0, 0.363298074153686, 0.006190565003676629; 0.636701925846314, 0.363298074153686, 0.006190565003676629; 0.363298074153686, 0.636701925846314, 0.006190565003676629; 0.0, 0.636701925846314, 0.006190565003676629; 0.636701925846314, 0.0, 0.006190565003676629; 0.132264581632714, 0.0, 0.003480578640489211; 0.0, 0.132264581632714, 0.003480578640489211; 0.867735418367286, 0.132264581632714, 0.003480578640489211; 0.132264581632714, 0.867735418367286, 0.003480578640489211; 0.0, 0.867735418367286, 0.003480578640489211; 0.867735418367286, 0.0, 0.003480578640489211; 0.4578368380791611, 0.4578368380791611, 0.03453043037728279; 0.08432632384167782, 0.4578368380791611, 0.03453043037728279; 0.4578368380791611, 0.08432632384167782, 0.03453043037728279; 0.2568591072619591, 0.2568591072619591, 0.04590123763076286; 0.4862817854760818, 0.2568591072619591, 0.04590123763076286; 0.2568591072619591, 0.4862817854760818, 0.04590123763076286; 0.05752768441141011, 0.05752768441141011, 0.01162613545961757; 0.8849446311771798, 0.05752768441141011, 0.01162613545961757; 0.05752768441141011, 0.8849446311771798, 0.01162613545961757; 0.07819258362551702, 0.22100121875989, 0.02727857596999626; 0.22100121875989, 0.07819258362551702, 0.02727857596999626; 0.700806197614593, 0.22100121875989, 0.02727857596999626; 0.22100121875989, 0.700806197614593, 0.02727857596999626; 0.07819258362551702, 0.700806197614593, 0.02727857596999626; 0.700806197614593, 0.07819258362551702, 0.02727857596999626; ];
        ORDER11POINT36_v1 = [0.0, 0.0, 6.082563295533433E-4; 1.0, 0.0, 6.082563295533433E-4; 0.0, 1.0, 6.082563295533433E-4; 0.306421156528904, 0.0, 0.004862551311214688; 0.0, 0.306421156528904, 0.004862551311214688; 0.693578843471096, 0.306421156528904, 0.004862551311214688; 0.306421156528904, 0.693578843471096, 0.004862551311214688; 0.0, 0.693578843471096, 0.004862551311214688; 0.693578843471096, 0.0, 0.004862551311214688; 0.09055112635267586, 0.0, 0.00287748881220936; 0.0, 0.09055112635267586, 0.00287748881220936; 0.9094488736473242, 0.09055112635267586, 0.00287748881220936; 0.09055112635267586, 0.9094488736473242, 0.00287748881220936; 0.0, 0.9094488736473242, 0.00287748881220936; 0.9094488736473242, 0.0, 0.00287748881220936; 0.4771441370462489, 0.4771441370462489, 0.02423831099156024; 0.045711725907502165, 0.4771441370462489, 0.02423831099156024; 0.4771441370462489, 0.045711725907502165, 0.02423831099156024; 0.06877574115942409, 0.06877574115942409, 0.01229878329128456; 0.8624485176811518, 0.06877574115942409, 0.01229878329128456; 0.06877574115942409, 0.8624485176811518, 0.01229878329128456; 0.3924791119734775, 0.3924791119734775, 0.03302578307250388; 0.21504177605304498, 0.3924791119734775, 0.03302578307250388; 0.3924791119734775, 0.21504177605304498, 0.03302578307250388; 0.7265336385659892, 0.2115723052694821, 0.01754479406987699; 0.2115723052694821, 0.7265336385659892, 0.01754479406987699; 0.06189405616452873, 0.2115723052694821, 0.01754479406987699; 0.2115723052694821, 0.06189405616452873, 0.01754479406987699; 0.7265336385659892, 0.06189405616452873, 0.01754479406987699; 0.06189405616452873, 0.7265336385659892, 0.01754479406987699; 0.585035254728082, 0.1437555396489239, 0.02296293229758128; 0.1437555396489239, 0.585035254728082, 0.02296293229758128; 0.27120920562299405, 0.1437555396489239, 0.02296293229758128; 0.1437555396489239, 0.27120920562299405, 0.02296293229758128; 0.585035254728082, 0.27120920562299405, 0.02296293229758128; 0.27120920562299405, 0.585035254728082, 0.02296293229758128; ];
        ORDER11POINT36_v2 = [0.0, 0.0, 4.583058548765858E-4; 1.0, 0.0, 4.583058548765858E-4; 0.0, 1.0, 4.583058548765858E-4; 0.3729607034612477, 0.0, 0.004697276305236619; 0.0, 0.3729607034612477, 0.004697276305236619; 0.6270392965387523, 0.3729607034612477, 0.004697276305236619; 0.3729607034612477, 0.6270392965387523, 0.004697276305236619; 0.0, 0.6270392965387523, 0.004697276305236619; 0.6270392965387523, 0.0, 0.004697276305236619; 0.1553066665135477, 0.0, 0.00336707045722312; 0.0, 0.1553066665135477, 0.00336707045722312; 0.8446933334864524, 0.1553066665135477, 0.00336707045722312; 0.1553066665135477, 0.8446933334864524, 0.00336707045722312; 0.0, 0.8446933334864524, 0.00336707045722312; 0.8446933334864524, 0.0, 0.00336707045722312; 0.2117511055315521, 0.2117511055315521, 0.02849177084300189; 0.5764977889368958, 0.2117511055315521, 0.02849177084300189; 0.2117511055315521, 0.5764977889368958, 0.02849177084300189; 0.04482616793714728, 0.04482616793714728, 0.008948103929621387; 0.9103476641257054, 0.04482616793714728, 0.008948103929621387; 0.04482616793714728, 0.9103476641257054, 0.008948103929621387; 0.3943145502141118, 0.3943145502141118, 0.03275210436109946; 0.21137089957177635, 0.3943145502141118, 0.03275210436109946; 0.3943145502141118, 0.21137089957177635, 0.03275210436109946; 0.06757028284160586, 0.3686932305165343, 0.02135074610440116; 0.3686932305165343, 0.06757028284160586, 0.02135074610440116; 0.5637364866418599, 0.3686932305165343, 0.02135074610440116; 0.3686932305165343, 0.5637364866418599, 0.02135074610440116; 0.06757028284160586, 0.5637364866418599, 0.02135074610440116; 0.5637364866418599, 0.06757028284160586, 0.02135074610440116; 0.7474371355107265, 0.1845656598467499, 0.01859309797217277; 0.1845656598467499, 0.7474371355107265, 0.01859309797217277; 0.06799720464252354, 0.1845656598467499, 0.01859309797217277; 0.1845656598467499, 0.06799720464252354, 0.01859309797217277; 0.7474371355107265, 0.06799720464252354, 0.01859309797217277; 0.06799720464252354, 0.7474371355107265, 0.01859309797217277; ];
        ORDER11POINT36_v3 = [0.0, 0.0, 6.582643475372946E-4; 1.0, 0.0, 6.582643475372946E-4; 0.0, 1.0, 6.582643475372946E-4; 0.09690885505427367, 0.0, 0.002887997749452224; 0.0, 0.09690885505427367, 0.002887997749452224; 0.9030911449457263, 0.09690885505427367, 0.002887997749452224; 0.09690885505427367, 0.9030911449457263, 0.002887997749452224; 0.0, 0.9030911449457263, 0.002887997749452224; 0.9030911449457263, 0.0, 0.002887997749452224; 0.3096278562392895, 0.0, 0.004963909456227002; 0.0, 0.3096278562392895, 0.004963909456227002; 0.6903721437607104, 0.3096278562392895, 0.004963909456227002; 0.3096278562392895, 0.6903721437607104, 0.004963909456227002; 0.0, 0.6903721437607104, 0.004963909456227002; 0.6903721437607104, 0.0, 0.004963909456227002; 0.3916553803852403, 0.3916553803852403, 0.03153470767800203; 0.21668923922951944, 0.3916553803852403, 0.03153470767800203; 0.3916553803852403, 0.21668923922951944, 0.03153470767800203; 0.066099272869529, 0.066099272869529, 0.01195547103823643; 0.867801454260942, 0.066099272869529, 0.01195547103823643; 0.066099272869529, 0.867801454260942, 0.01195547103823643; 0.4765910774305102, 0.4765910774305102, 0.02438923490441436; 0.046817845138979575, 0.4765910774305102, 0.02438923490441436; 0.4765910774305102, 0.046817845138979575, 0.02438923490441436; 0.2119280804570003, 0.06549274992240128, 0.01905592143754818; 0.06549274992240128, 0.2119280804570003, 0.01905592143754818; 0.7225791696205984, 0.06549274992240128, 0.01905592143754818; 0.06549274992240128, 0.7225791696205984, 0.01905592143754818; 0.2119280804570003, 0.7225791696205984, 0.01905592143754818; 0.7225791696205984, 0.2119280804570003, 0.01905592143754818; 0.1482693720952231, 0.2753149271480059, 0.02215666570601087; 0.2753149271480059, 0.1482693720952231, 0.02215666570601087; 0.5764157007567711, 0.2753149271480059, 0.02215666570601087; 0.2753149271480059, 0.5764157007567711, 0.02215666570601087; 0.1482693720952231, 0.5764157007567711, 0.02215666570601087; 0.5764157007567711, 0.1482693720952231, 0.02215666570601087; ];
        ORDER11POINT36_v4 = [0.0, 0.0, 6.977749977819948E-4; 1.0, 0.0, 6.977749977819948E-4; 0.0, 1.0, 6.977749977819948E-4; 0.1042032950377326, 0.0, 0.002929845918662817; 0.0, 0.1042032950377326, 0.002929845918662817; 0.8957967049622674, 0.1042032950377326, 0.002929845918662817; 0.1042032950377326, 0.8957967049622674, 0.002929845918662817; 0.0, 0.8957967049622674, 0.002929845918662817; 0.8957967049622674, 0.0, 0.002929845918662817; 0.3145461912846608, 0.0, 0.005039500082674611; 0.0, 0.3145461912846608, 0.005039500082674611; 0.6854538087153392, 0.3145461912846608, 0.005039500082674611; 0.3145461912846608, 0.6854538087153392, 0.005039500082674611; 0.0, 0.6854538087153392, 0.005039500082674611; 0.6854538087153392, 0.0, 0.005039500082674611; 0.4758221914754834, 0.4758221914754834, 0.02457088105214646; 0.04835561704903324, 0.4758221914754834, 0.02457088105214646; 0.4758221914754834, 0.04835561704903324, 0.02457088105214646; 0.3906745108966545, 0.3906745108966545, 0.0297258561992511; 0.218650978206691, 0.3906745108966545, 0.0297258561992511; 0.3906745108966545, 0.218650978206691, 0.0297258561992511; 0.06375763489822163, 0.06375763489822163, 0.01178089444287955; 0.8724847302035568, 0.06375763489822163, 0.01178089444287955; 0.06375763489822163, 0.8724847302035568, 0.01178089444287955; 0.06856705032286133, 0.2129399133002941, 0.0205239905920948; 0.2129399133002941, 0.06856705032286133, 0.0205239905920948; 0.7184930363768445, 0.2129399133002941, 0.0205239905920948; 0.2129399133002941, 0.7184930363768445, 0.0205239905920948; 0.06856705032286133, 0.7184930363768445, 0.0205239905920948; 0.7184930363768445, 0.06856705032286133, 0.0205239905920948; 0.5668085553115408, 0.1535990892761941, 0.02145229339387155; 0.1535990892761941, 0.5668085553115408, 0.02145229339387155; 0.27959235541226507, 0.1535990892761941, 0.02145229339387155; 0.1535990892761941, 0.27959235541226507, 0.02145229339387155; 0.5668085553115408, 0.27959235541226507, 0.02145229339387155; 0.27959235541226507, 0.5668085553115408, 0.02145229339387155; ];
        ORDER11POINT36_v5 = [0.0, 0.0, 7.843097667098473E-4; 1.0, 0.0, 7.843097667098473E-4; 0.0, 1.0, 7.843097667098473E-4; 0.3544815779297824, 0.0, 0.005360806770285871; 0.0, 0.3544815779297824, 0.005360806770285871; 0.6455184220702176, 0.3544815779297824, 0.005360806770285871; 0.3544815779297824, 0.6455184220702176, 0.005360806770285871; 0.0, 0.6455184220702176, 0.005360806770285871; 0.6455184220702176, 0.0, 0.005360806770285871; 0.1398215631416714, 0.0, 0.003612423945705114; 0.0, 0.1398215631416714, 0.003612423945705114; 0.8601784368583286, 0.1398215631416714, 0.003612423945705114; 0.1398215631416714, 0.8601784368583286, 0.003612423945705114; 0.0, 0.8601784368583286, 0.003612423945705114; 0.8601784368583286, 0.0, 0.003612423945705114; 0.2398646683066885, 0.2398646683066885, 0.02935538218715718; 0.520270663386623, 0.2398646683066885, 0.02935538218715718; 0.2398646683066885, 0.520270663386623, 0.02935538218715718; 0.05939841826003461, 0.05939841826003461, 0.01259016943796081; 0.8812031634799308, 0.05939841826003461, 0.01259016943796081; 0.05939841826003461, 0.8812031634799308, 0.01259016943796081; 0.3982780592047566, 0.3982780592047566, 0.02477162854391181; 0.20344388159048676, 0.3982780592047566, 0.02477162854391181; 0.3982780592047566, 0.20344388159048676, 0.02477162854391181; 0.07938836834591467, 0.2240733927557592, 0.02637983755607086; 0.2240733927557592, 0.07938836834591467, 0.02637983755607086; 0.6965382388983261, 0.2240733927557592, 0.02637983755607086; 0.2240733927557592, 0.6965382388983261, 0.02637983755607086; 0.07938836834591467, 0.6965382388983261, 0.02637983755607086; 0.6965382388983261, 0.07938836834591467, 0.02637983755607086; 0.4365216866929358, 0.4976858328596177, 0.01422952009340166; 0.4976858328596177, 0.4365216866929358, 0.01422952009340166; 0.06579248044744651, 0.4976858328596177, 0.01422952009340166; 0.4976858328596177, 0.06579248044744651, 0.01422952009340166; 0.4365216866929358, 0.06579248044744651, 0.01422952009340166; 0.06579248044744651, 0.4365216866929358, 0.01422952009340166; ];
        ORDER11POINT36_v6 = [0.0, 0.0, 4.762675286979898E-4; 1.0, 0.0, 4.762675286979898E-4; 0.0, 1.0, 4.762675286979898E-4; 0.07993870924925774, 0.0, 0.002897841311190826; 0.0, 0.07993870924925774, 0.002897841311190826; 0.9200612907507423, 0.07993870924925774, 0.002897841311190826; 0.07993870924925774, 0.9200612907507423, 0.002897841311190826; 0.0, 0.9200612907507423, 0.002897841311190826; 0.9200612907507423, 0.0, 0.002897841311190826; 0.3055529243612937, 0.0, 0.004491124346734268; 0.0, 0.3055529243612937, 0.004491124346734268; 0.6944470756387062, 0.3055529243612937, 0.004491124346734268; 0.3055529243612937, 0.6944470756387062, 0.004491124346734268; 0.0, 0.6944470756387062, 0.004491124346734268; 0.6944470756387062, 0.0, 0.004491124346734268; 0.3935851990719148, 0.3935851990719148, 0.03517078577575594; 0.2128296018561704, 0.3935851990719148, 0.03517078577575594; 0.3935851990719148, 0.2128296018561704, 0.03517078577575594; 0.07473300699993816, 0.07473300699993816, 0.01350590535760379; 0.8505339860001236, 0.07473300699993816, 0.01350590535760379; 0.07473300699993816, 0.8505339860001236, 0.01350590535760379; 0.4778706061592321, 0.4778706061592321, 0.02387982403384744; 0.044258787681535794, 0.4778706061592321, 0.02387982403384744; 0.4778706061592321, 0.044258787681535794, 0.02387982403384744; 0.2645456108709536, 0.1360625094869939, 0.02498014209662454; 0.1360625094869939, 0.2645456108709536, 0.02498014209662454; 0.5993918796420525, 0.1360625094869939, 0.02498014209662454; 0.1360625094869939, 0.5993918796420525, 0.02498014209662454; 0.2645456108709536, 0.5993918796420525, 0.02498014209662454; 0.5993918796420525, 0.2645456108709536, 0.02498014209662454; 0.1360625094869939, 0.05194908177061736, 0.01444783423083112; 0.05194908177061736, 0.1360625094869939, 0.01444783423083112; 0.8119884087423888, 0.05194908177061736, 0.01444783423083112; 0.05194908177061736, 0.8119884087423888, 0.01444783423083112; 0.1360625094869939, 0.8119884087423888, 0.01444783423083112; 0.8119884087423888, 0.1360625094869939, 0.01444783423083112; ];
        ORDER11POINT36_v7 = [0.0, 0.0, 1.203429728164228E-4; 1.0, 0.0, 1.203429728164228E-4; 0.0, 1.0, 1.203429728164228E-4; 0.03022257440499967, 0.0, 0.005648070482775567; 0.0, 0.03022257440499967, 0.005648070482775567; 0.9697774255950004, 0.03022257440499967, 0.005648070482775567; 0.03022257440499967, 0.9697774255950004, 0.005648070482775567; 0.0, 0.9697774255950004, 0.005648070482775567; 0.9697774255950004, 0.0, 0.005648070482775567; 0.04292407100635661, 0.0, 0.001434742885973307; 0.0, 0.04292407100635661, 0.001434742885973307; 0.9570759289936434, 0.04292407100635661, 0.001434742885973307; 0.04292407100635661, 0.9570759289936434, 0.001434742885973307; 0.0, 0.9570759289936434, 0.001434742885973307; 0.9570759289936434, 0.0, 0.001434742885973307; 0.4762621668242898, 0.4762621668242898, 0.02450497451803485; 0.04747566635142042, 0.4762621668242898, 0.02450497451803485; 0.4762621668242898, 0.04747566635142042, 0.02450497451803485; 0.2030717695662224, 0.4673667678466049, 0.0259118774639745; 0.4673667678466049, 0.2030717695662224, 0.0259118774639745; 0.32956146258717267, 0.4673667678466049, 0.0259118774639745; 0.4673667678466049, 0.32956146258717267, 0.0259118774639745; 0.2030717695662224, 0.32956146258717267, 0.0259118774639745; 0.32956146258717267, 0.2030717695662224, 0.0259118774639745; 0.03635255445202758, 0.1150656775801793, 0.01112690810816592; 0.1150656775801793, 0.03635255445202758, 0.01112690810816592; 0.8485817679677932, 0.1150656775801793, 0.01112690810816592; 0.1150656775801793, 0.8485817679677932, 0.01112690810816592; 0.03635255445202758, 0.8485817679677932, 0.01112690810816592; 0.8485817679677932, 0.03635255445202758, 0.01112690810816592; 0.03635255445202758, 0.1150656775801793, 0.0268990756470184; 0.1150656775801793, 0.03635255445202758, 0.0268990756470184; 0.8485817679677932, 0.1150656775801793, 0.0268990756470184; 0.1150656775801793, 0.8485817679677932, 0.0268990756470184; 0.03635255445202758, 0.8485817679677932, 0.0268990756470184; 0.8485817679677932, 0.03635255445202758, 0.0268990756470184; ];
        ORDER11POINT36_v8 = [0.0, 0.0, 7.892941754415492E-4; 1.0, 0.0, 7.892941754415492E-4; 0.0, 1.0, 7.892941754415492E-4; 0.1484823026200776, 0.0, 0.002438106746957435; 0.0, 0.1484823026200776, 0.002438106746957435; 0.8515176973799223, 0.1484823026200776, 0.002438106746957435; 0.1484823026200776, 0.8515176973799223, 0.002438106746957435; 0.0, 0.8515176973799223, 0.002438106746957435; 0.8515176973799223, 0.0, 0.002438106746957435; 0.3388501069491062, 0.0, 0.005477346210172896; 0.0, 0.3388501069491062, 0.005477346210172896; 0.6611498930508938, 0.3388501069491062, 0.005477346210172896; 0.3388501069491062, 0.6611498930508938, 0.005477346210172896; 0.0, 0.6611498930508938, 0.005477346210172896; 0.6611498930508938, 0.0, 0.005477346210172896; 0.4701249674269392, 0.4701249674269392, 0.02656035113426609; 0.05975006514612158, 0.4701249674269392, 0.02656035113426609; 0.4701249674269392, 0.05975006514612158, 0.02656035113426609; 0.2246917714197549, 0.08454313312796995, 0.02721390945227405; 0.08454313312796995, 0.2246917714197549, 0.02721390945227405; 0.6907650954522752, 0.08454313312796995, 0.02721390945227405; 0.08454313312796995, 0.6907650954522752, 0.02721390945227405; 0.2246917714197549, 0.6907650954522752, 0.02721390945227405; 0.6907650954522752, 0.2246917714197549, 0.02721390945227405; 0.08481558435195644, 0.03631639883870029, 0.007684436539507441; 0.03631639883870029, 0.08481558435195644, 0.007684436539507441; 0.8788680168093432, 0.03631639883870029, 0.007684436539507441; 0.03631639883870029, 0.8788680168093432, 0.007684436539507441; 0.08481558435195644, 0.8788680168093432, 0.007684436539507441; 0.8788680168093432, 0.08481558435195644, 0.007684436539507441; 0.3148364616424038, 0.4785704481357608, 0.0268447117295677; 0.4785704481357608, 0.3148364616424038, 0.0268447117295677; 0.20659309022183547, 0.4785704481357608, 0.0268447117295677; 0.4785704481357608, 0.20659309022183547, 0.0268447117295677; 0.3148364616424038, 0.20659309022183547, 0.0268447117295677; 0.20659309022183547, 0.3148364616424038, 0.0268447117295677; ];
    end

    methods (Access = private, Static = true)

        function pointAndWeights = transformPoints(triangle, integralPoints)
            % Transform the given points from the integral coordinates to the real
            % coordinates of the given triangle.
            %
            % Parameters:
            %   triangle (simplexIntegral.polygons.Triangle): The triangle to transform the points to
            %   integralPoints (:, 3) (double): The points to transform
            %       The points are given as a matrix, where each row is a point, and
            %       the columns are the coordinates of the points.
            %       The first column is the x coordinate, the second column is the y
            %       coordinate, and the third column is the weight of the point.
            %
            % Returns:
            %   The transformed points in the real coordinates of the given triangle.
            %
            % See also: simplexIntegral.polygons.Triangle, simplexIntegral.integrals.IntegralPointWithWeight

            arguments
                triangle {mustBeA(triangle, 'Triangle')}
                integralPoints (:, 3) {mustBeReal, mustBeFinite}
            end

            vertices = triangle.getVertices();
            pointAndWeights = zeros(size(integralPoints));
            % The transformation is done with the following formulas:
            % x = x3 + li * (x1 - x3) + lj * (x2 - x3)
            % y = y3 + li * (y1 - y3) + lj * (y2 - y3)
            % where (x1, y1), (x2, y2), and (x3, y3) are the coordinates of the vertices of
            % this triangle, and
            % (li, lj) are the coordinates of the point in the integral.
            pointAndWeights(:, 1) = vertices(2, 1) + integralPoints(:, 1) .* (vertices(1, 1) - vertices(2, 1)) + integralPoints(:, 2) .* (vertices(3, 1) - vertices(2, 1)); % x
            pointAndWeights(:, 2) = vertices(2, 2) + integralPoints(:, 1) .* (vertices(1, 2) - vertices(2, 2)) + integralPoints(:, 2) .* (vertices(3, 2) - vertices(2, 2)); % y
            pointAndWeights(:, 3) = integralPoints(:, 3); % weight
        end

        function points = getSimplexPoints(integrateName)
            % Get the points for the given integration order.
            %
            % Parameters:
            %   integrateName (char): The name of the integration order.
            %       The possible values are in the docstring of the class.
            %
            % Returns:
            %   The points of the integration.
            %
            % See also: simplexIntegral.TriangleSimplexIntegral

            arguments
                integrateName
            end

            % The points of the integration.
            %
            % The points are given as a matrix, where each row is a point, and
            % the columns are the coordinates of the points.
            % The first column is the x coordinate, the second column is the y
            % coordinate, and the third column is the weight of the point.
            switch integrateName
                case 'ORDER1POINT3'
                    points = TriangleSimplexIntegral.ORDER1POINT3; % 1 order, 3 points
                case 'ORDER3POINT7'
                    points = TriangleSimplexIntegral.ORDER3POINT7; % 3 order, 7 points
                case 'ORDER5POINT12'
                    points = TriangleSimplexIntegral.ORDER5POINT12; % 5 order, 12 points
                case 'ORDER7POINT18'
                    points = TriangleSimplexIntegral.ORDER7POINT18; % 7 order, 18 points
                case 'ORDER7POINT27'
                    points = TriangleSimplexIntegral.ORDER7POINT27; % 7 order, 27 points
                case 'ORDER10POINT30'
                    points = TriangleSimplexIntegral.ORDER10POINT30; % 10 order, 30 points
                case 'ORDER11POINT36_v1'
                    points = TriangleSimplexIntegral.ORDER11POINT36_v1; % order 11, 36 points (1)
                case 'ORDER11POINT36_v2'
                    points = TriangleSimplexIntegral.ORDER11POINT36_v2; % order 11, 36 points (2)
                case 'ORDER11POINT36_v3'
                    points = TriangleSimplexIntegral.ORDER11POINT36_v3; % order 11, 36 points (3)
                case 'ORDER11POINT36_v4'
                    points = TriangleSimplexIntegral.ORDER11POINT36_v4; % order 11, 36 points (4)
                case 'ORDER11POINT36_v5'
                    points = TriangleSimplexIntegral.ORDER11POINT36_v5; % order 11, 36 points (5)
                case 'ORDER11POINT36_v6'
                    points = TriangleSimplexIntegral.ORDER11POINT36_v6; % order 11, 36 points (6)
                case 'ORDER11POINT36_v7'
                    points = TriangleSimplexIntegral.ORDER11POINT36_v7; % order 11, 36 points (7)
                case 'ORDER11POINT36_v8'
                    points = TriangleSimplexIntegral.ORDER11POINT36_v8; % order 11, 36 points (8)
            end

        end

    end

    methods (Access = public, Static = true)

        function integral = integrate(triangle, func, integrateName)
            %INTEGRATE Calculate the integral of the given function over the given triangle.
            %
            % Parameters:
            %   triangle (simplexIntegral.polygons.Triangle): The triangle to integrate over
            %   func (function_handle): The function to integrate
            %   integrateName (char): The name of the integration order.
            %       The possible values are in the docstring of the class.
            %   see https://hsmkhexo.s3.ap-northeast-1.amazonaws.com/other/%E7%A7%AF%E5%88%86%E5%85%AC%E5%BC%8F%E6%80%BB%E7%BB%93.pdf
            %
            % Returns:
            %   The integral of the function over the triangle.
            %
            % See also: simplexIntegral.polygons.Triangle, function_handle, simplexIntegral.TriangleSimplexIntegral

            arguments
                triangle {mustBeA(triangle, 'Triangle')}
                func {mustBeA(func, 'function_handle')}
                integrateName
            end

            if (~ismember(upper(integrateName), TriangleSimplexIntegral.formulas))
                error('The integrateName must be one of the following: %s', strjoin(TriangleSimplexIntegral.formulas, ', '));
            end

            % Check if the function takes exactly 2 arguments
            if (nargin(func) ~= 2)
                error('The function must take exactly 2 arguments');
            end

            % Try to evaluate the function at the vertices of the triangle
            % to check if vector operations are supported
            try
                % Get the vertices of the triangle
                temp = triangle.getVertices();
                func(temp(:, 2), temp(:, 1));
            catch
                error('Vector operations are not supported for the function');
            end

            % First, transform the points from the integral coordinates to the real
            % coordinates of the given triangle.
            % The points are given as a matrix, where each row is a point, and
            % the columns are the coordinates of the points.
            % The first column is the x coordinate, the second column is the y
            % coordinate, and the third column is the weight of the point.
            transformedPoints = TriangleSimplexIntegral.transformPoints(triangle, TriangleSimplexIntegral.getSimplexPoints(integrateName));

            % Then, calculate the integral of the function over the triangle.
            % The integral is calculated as the sum of the function values at the points
            % multiplied by the weights.
            % The integral is multiplied by 2 because the triangle is in the xy-plane,
            % but the integration is in the xz-plane.
            integral = 2 * triangle.getArea() * sum(func(transformedPoints(:, 1), transformedPoints(:, 2)) .* transformedPoints(:, 3));
        end

    end

end
